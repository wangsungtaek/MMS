<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="reviewer">
    <parameterMap id="parameterMap" type="com.mms.common.system.data.CamelDataHashMap" />
    <resultMap id="resultMap" type="com.mms.common.system.data.CamelDataHashMap" />

    <!-- 블로거 조회  -->
    <select id="findBloger" resultMap="resultMap" parameterMap="parameterMap">
        SELECT  REVIEWER_ID
                ,REVIEWER_NM
                ,KAKAO_ID
                ,AGE
                ,CATEGORY_ID AS CATEGORY
                ,BLOG_NM
                ,BLOG_LINK
                ,EMAIL
                ,ADDRESS
                ,TEL_NO
                ,VISIT
                ,POST_NO
                ,IMPORTANT
                ,REMARK
          FROM  REVIEWER
         WHERE  REVIEWER_DIV = 'blog'
        <if test="important != '' and important != null">
             AND IMPORTANT = #{important}
        </if>
        <if test="category != '' and category != null">
             AND CATEGORY_ID = #{category}
        </if>
        <if test="searchDiv == 'name' and searchWord != '' and searchWord != null">
            AND REVIEWER_NM LIKE '%'||#{searchWord}||'%'
        </if>
        <if test="searchDiv == 'remark' and searchWord != '' and searchWord != null">
            AND REMARK LIKE '%'||#{searchWord}||'%'
        </if>
        ORDER BY CREATE_DT DESC
    </select>

    <!-- 블로거 등록 -->
    <insert id="createBloger" parameterMap="parameterMap">
        INSERT INTO REVIEWER (
            REVIEWER_NM
            ,REVIEWER_DIV
            ,KAKAO_ID
            ,AGE
            ,SIGNUP_PATH
            ,CATEGORY_ID
            ,BLOG_NM
            ,BLOG_LINK
            ,EMAIL
            ,IMPORTANT
            ,TEL_NO
            ,ADDRESS
            ,POST_NO
            ,VISIT
            ,REMARK
            ,CREATE_DT
        ) VALUES (
            #{reviewerNm}
            ,#{division}
            ,#{kakaoId}
            ,#{age}
            ,#{signupPath}
            ,#{category}
            ,#{blogNm}
            ,#{blogLink}
            ,#{email}
            ,#{important}
            ,#{telNo}
            ,#{address}
            ,#{postNo}
            ,#{visit}
            ,#{remark}
            ,NOW()
        )
    </insert>

    <!-- 블로거 업데이트 -->
    <update id="updateBloger" parameterMap="parameterMap">
        UPDATE REVIEWER
        SET REVIEWER_NM = #{reviewerNm}
            ,KAKAO_ID = #{kakaoId}
            ,AGE = #{age}
            ,CATEGORY_ID = #{category}
            ,BLOG_NM = #{blogNm}
            ,BLOG_LINK = #{blogLink}
            ,EMAIL = #{email}
            ,IMPORTANT = #{important}
            ,TEL_NO = #{telNo}
            ,ADDRESS = #{address}
            ,POST_NO = #{postNo}
            ,VISIT = #{visit}
            ,REMARK = #{remark}
            ,UPDATE_DT = NOW()
        WHERE 	REVIEWER_ID = #{reviewerId}
    </update>

    <!-- 블로거 삭제 -->
    <delete id="deleteBloger" parameterMap="parameterMap">
        DELETE FROM REVIEWER
        WHERE REVIEWER_ID = #{reviewerId}
    </delete>
</mapper>